---
layout: single
title:  "엔티티, 엔티티 매니져, 엔티티 팩토리, 어노테이션 정리"
---
# 엔티티(Entity)

- 테이블과 매칭되는 개념(클래스 또는 객체)
- 객체와 데이터베이스 사이의 개념이라고 생각하면 된다.
- @Entity가 붙은 클래스틑 JPA가 관리한다.

# 엔티티매니져(Entity Manager)

- 엔티티를 DB 에 등록/수정/삭제/조회 하는 역할
- 영속성 컨택스트를 생성하고, 이를통해 엔티티를 관리한다.
- DB의 커넥션이라 생각하면 편하다. (하지만 엄밀히 커넥션은 아님) 따라서 무조건 종료 시켜줘야한다.
- 트랜젝션을 관리 한다.
- 엔티티 매니저가 persist() 메서드를 사용하면 엔티티를 영속성 컨텍스트에 저장한다.

# 엔티티 생명주기

1. 비영속 (new/transient) : 영속성 컨텍스트와 관계가 없는 상태 (객체 생성)
2. 영속 (managed) : 영속성 컨텍스트에 저장된 상태 (persist메소드 호출)
3. 준영속 (detached) : 영속성 컨텍스트에 저장되어있다가 분리된 상태 (detatch메소드 호출)
4. 삭제 (removed) : 삭제된 상태 (remove 메소드 호출)

# 영속성 컨택스트(**Persistence context**)

- 엔티티를 영구히 저장하는 환경 
(엔티티 매니져가 엔티티를 저장하면 영속성 컨택스트에 저장한다.)
- 영속성 컨택스트는 관리하는 엔티티를 추적한다. 만약 엔티티에 변화가 일어난다면 엔티티에 표시하고 트랜젝션이 끝나는 시점에 표시한 내용을 DB에 반영한다. (Dirty_checking이라한다.)
- 캐시 기능이있어 같은 트랜젝션 안 동일 데이터 조회시 성능을 향상 시켜준다.

# 엔티티 매니져 팩토리

- persistance.xml 파일의 정보를 조회후 설정 정보에 맞게 DB커넥션 풀을 생성한다.
→리소스를 많이 잡아 먹음, 데이터베이스 하나당 하나 정도로 사용
- 반드시 종료!

# 어노테이션 ( 더 추가할 예정 )

자바에서는 @를 이용해 컴파일러에게 특정 상황을 알려줄수있고 컴파일러는 그에 따른 행동을 할수있다.

ex) @override

JPA에서 사용하는 어노테이션을 정리한다.

1. @Entity : 테이블과 매핑할 클래스에 적어준다.
2. @Table : 매핑할 클래스에게 테이블 정보를 알려준다.
    
    속성들
    
    - name : 매핑할 테이블 명 (안적으면 클래스명이 테이블 이름이 된다)
    - catalog : catalog 기능이 있는 DB 에서 catalog 를 매핑
    - schema : schema 기능이 있는 DB 에서 schema 를 매핑
3. @Id : PK를 매핑한다.
4. @Column : 필드를 컬럼에 매핑한다.
    
    속성들
    
    - name : 매핑할 컬럼을 지정한다. (디폴트는 개체의 필드 이름)